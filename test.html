<!doctype html>
<html lang="fr">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>reveal.js</title>

	<link rel="stylesheet" href="dist/reset.css">
	<link rel="stylesheet" href="dist/reveal.css">
	<link rel="stylesheet" href="dist/theme/black.css">

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="plugin/highlight/monokai.css">
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<section>
					<section>
						<h1>Tester une application</h1>
					</section>
				</section>
				<section>
					<h1>Pourquoi tester ?</h1>
					<img src="assets/douter.jpg" alt="Image illustrant le concept de pourquoi tester">
				</section>
				<section>
					<h1>Pourquoi tester ?</h1>
					<ul>
						<li>Vérifier qu'il n'y a pas de régression</li>
						<li>Vérifier que les nouvelles fonctionnalités fonctionnent</li>
					</ul>
				</section>
				<section>
					<h1>Comment tester ?</h1>
					<img src="assets/test-pira.jpg" alt="Schéma représentant comment tester" />
				</section>
				<section>
					<h1>Quand tester ?</h1>
					<div class="r-stack">
						<img class="fragment" src="assets/test-1-legend.jpg" alt="Légende de la première itération de test"/>
						<img class="fragment" src="assets/test-1-iteration.png" alt="Image de la première itération de test"/>
						<img class="fragment" src="assets/test-3-iteration.png" alt="Image de la troisième itération de test"/>
					</div>
				</section>
			</section>
			<section>
				<section>
					<h1>TDD</h1>
				</section>
				<section> 
					<h2>C'est quoi TDD</h2>
					<img src="assets/tdd.webp" alt="Image représentant le développement dirigé par les tests">
				</section>
				<section>
					<h2>Pourquoi ?</h2>
					<ul>
						<li>Réduire le temps de dev</li>
						<li>Faire des tests de qualité</li>
					</ul>
				</section>
				<section>
					<h2>Pourquoi on gagne du temps</h2>
				</section>
				<section>
					<h2>À la main</h2>
					<ul>
						<li>Démarrer l'appli </li>
						<li>Préparer / reset les données</li>
						<li>Vérifier le résultat</li>
					</ul>
				</section>
				<section>
					<h2>Avec des Tests</h2>
					<ul>
						<li>Lancer le test</li>
					</ul>
				</section>
				<section>
					<h2>Mon (vrai) avis sur le tdd</h2>
					<ul>
						<li>Essentiel pour le débogage</li>
						<li>Pratique pour des POC techniques</li>
					        <li>Compliqué pour réfléchir à une architecture</li>
					</ul>
				</section>

			</section>
			<section>
				<section>
					<h1>Les tests unitaires</h1>
					<ul>
						Objectif :
						<li>Tester une classe</li>
						<li>Mocker les dépendances</li>
					</ul>
				</section>
				<section>
					<h1>C'est quoi un mock ? </h1>
					<ul>
						<li>Le mock est un "faux" objet</li>
						<li>On décrit les retours de chaque méthode</li>
						<iframe src="https://giphy.com/embed/3o84U6421OOWegpQhq" width="480" height="270"
							frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
						<p><a href="https://giphy.com/gifs/tipsyelves-rainbow-magic-3o84U6421OOWegpQhq"></a></p>
					</ul>
				</section>
				<section>
					<h1>Exemple de Mock avec Mockito</h1>
					<pre><code class="hljs language-java">@InjectMocks
private Calculator calculator;

@Mock
private AdditionService additionService;

// Exemple d'utilisation
@Test
public void testAdd() {
    Mockito.when(additionService.add(2, 3)).thenReturn(5);
    int result = calculator.calculate(2, 3);
    assertEquals(5, result);
    Mockito.verify(additionService).add(2, 3);
}</code></pre>
				</section>
				<section>
					<iframe src="https://giphy.com/embed/f6z5TkrTIBZILYOd1t" width="480" height="480" frameBorder="0"
						class="giphy-embed" allowFullScreen></iframe>
					<p><a href="https://giphy.com/gifs/NetflixisaJoke-netflix-iglesias-mr-f6z5TkrTIBZILYOd1t"></a>
					</p>
				</section>
				<section>
					<h1>Feature</h1>
					<ul>
						<li>Faire un virement d'un montant x entre 2 comptes.</li>
						<li>Retirer X au compte source et ajouter X au compte cible</li>
						<li>Le montant du virement doit être positif</li>
						<li>Si le compte source finit avec moins de 0 on envoie un montant de 0.5 vers le compte de la banque</li>
					</ul>
				</section>
				<section>
					<h1>Play Time</h1>
				</section>
				<section>
					<h1>Play time Angular</h1>
				</section>
			</section>
			<section>
				<section>
					<h1>Les tests d'intégrations</h1>
					<ul>
						<li>Lancer tout ou une partie de l'application</li>
						<li>Mets en place une base de données</li>
						<li>Quelques mocks (Services externes)</li>
					</ul>
				</section>
				<section>
					<h1>Pourquoi faire un test d'intégration</h1>
					<ul>
						<li>Tester la communication entre les classes</li>
						<li>Tester la communication avec le framework</li>
						<li>Vérifier la compatibilité de la base</li>
					</ul>
				</section>
				<section>
					<h2>Pourquoi faire des tests unitaires ? Les tests d'intégration ça suffit ? </h2>
					<div class="r-stack">
						<div class="fragment fade-in-then-out">
							<iframe src="https://giphy.com/embed/6XPmkX0c6Z868tLYu4" width="480" height="480"
								frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
							<p><a href="https://giphy.com/gifs/warning-danger-meter-6XPmkX0c6Z868tLYu4"></a>
							</p>
						</div>

						<ul class="fragment fade-left">
							<li>C'est long à exécuter</li>
							<li>C'est plus compliqué à maintenir</li>
							<li>C'est plus compliqué à déboguer</li>
						</ul>
					</div>
				</section>
				<section>
					<h2>Plusieurs niveaux de test d'intégration</h2>
					<ul>
						<li>Test de repository -> Test de la base</li>
						<li>Test de Service -> Test du framework + base/transaction</li>
						<li>Test de contrôleur -> Test auth + Mapping (JSON -> DTO -> Domain) + PATH </li>
					</ul>
				</section>
				<section>
					<h2>Test de contrôleur</h2>
					<ul>
						<li>Utiliser MockMvc</li>
						<li>Mocker les Services (On veut vérifier le mapping)</li>
					</ul>
				</section>
				<section>
					<h1>C'est quoi la base ? C'est pas un postgres ! </h1>
					<p>C'est une base H2</p>
					<p>Base SQL in memory, attention il y a des petites différences avec PostgreSQL</p>
				</section>
				<section>
					<h1>
						Je dois me connecter à un middleware comment faire
					</h1>
					<p>Essayer Testcontainers</p>
				</section>
				<section>
					<h1>Je teste mon client HTTP qui se connecte à l'API d'un fournisseur</h1>
					<p> Les tests ne doivent jamais faire de vraie requête vers un serveur externe</p>
				</section>
			</section>
			<section>
				<section>
					<h1>Les tests End-to-end</h1>
				</section>
				<section>
					<h2>Principe</h2>
					<ul>
						<li>Lancer une application complète (Middleware/BackEnd/FrontEnd)</li>
						<li>Simuler des actions sur un navigateur</li>
						<li>Vérifier le comportement de l'application</li>
					</ul>
				</section>
				<section>
					<h2>Objectif</h2>
					<ol>
						<li>Vérifier que tout communique correctement</li>
					</ol>
				</section>
				<section>
					<h2>Difficulté</h2>
					<ol>
						<li>Préparer la base</li>
						<li>Lourd à exécuter</li>
						<li>Lourd à écrire</li>
						<li>Quand les exécuter ?</li>
						<li>Difficile à maintenir</li>
					</ol>
				</section>
				<section>
					<h2>Faut-il le faire</h2>
					<ol>
						<li>Oui !!!</li>
						<li>Au moins sur les chemins usuels</li>
						<li>Ne remplace pas les tests manuels</li>
					</ol>
				</section>
				<section>
					<h2>Exemple avec Selenium</h2>
				</section>
			</section>
			<section>
				<h1>C'est quoi un fake*</h1>
				<ul>
					<li>Une implémentation simplifiée</li>
					<li>Exemple : remplace un repository par une implémentation qui stocke dans une map</li>
				</ul>
			</section>
		</div>
	</div>

	<script src="dist/reveal.js"></script>
	<script src="plugin/notes/notes.js"></script>
	<script src="plugin/markdown/markdown.js"></script>
	<script src="plugin/highlight/highlight.js"></script>
	<script src="/node_modules/reveal.js-mermaid-plugin/plugin/mermaid/mermaid.js"></script>
	<script src="/node_modules/reveal.js-plugins/seminar/plugin.js"></script>

	<script src="/node_modules/reveal.js-plugins/questions/plugin.js"></script>
	<link rel="stylesheet" href="/node_modules/reveal.js-plugins/questions/style.css" />

	<script src="/node_modules/reveal.js-plugins/chart/plugin.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.2.0/chart.min.js"></script>

	<script src="/node_modules/reveal.js-plugins/poll/plugin.js"></script>
	<link rel="stylesheet" href="/node_modules/reveal.js-plugins/poll/style.css" />


	<!-- Font awesome is used by several plugins -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

	<script src="/node_modules/reveal.js-plugins/customcontrols/plugin.js"></script>
	<link rel="stylesheet" href="/node_modules/reveal.js-plugins/customcontrols/style.css" />

	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.6.1/socket.io.js"></script>
	<script>
		// More info about initialization & config:
		// - https://revealjs.com/initialization/
		// - https://revealjs.com/config/
		Reveal.initialize({
			hash: true,
			customcontrols: {
				controls: [
					{
						id: 'toggle-questions',
						title: 'Toggle Q&A dashboard (Q)',
						icon: '<span class="fa-stack" style="margin: -24px -12px;padding:0;"><span class="fa-solid fa-comment fa-stack-1x"></span><strong class="fa-stack-1x fa-inverse qna question-counter" style="font-size:0.5em;"></strong></span>',
						action: 'RevealQnA.toggleQnA();'
					}
				]
			},
			mermaid: {
				// flowchart: {
				//   curve: 'linear',
				// },
			},
			seminar: {
				server: "https://seminar.ruokki.ovh",
				room: "Room",
				hash: "$2a$05$1sk9j57QocHqsOgvUQ3RQ.qhNq.QXNZ5TDHDasniq1QwFDksuDjEu",
				autoJoin: true
			},
			chart: {
				defaults: {
					backgroundColor: 'white'
				},
				bar: { backgroundColor: ["grey", "red", "grey"] },
			},
			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealMarkdown, RevealHighlight, RevealChart, RevealNotes, RevealMermaid, RevealCustomControls, RevealSeminar, RevealQnA, RevealPoll]
		});
		document.querySelector("#host").addEventListener('click', function (e) {
			console.log("Start seminar")
			RevealSeminar.open_or_join_room(document.getElementById('password').value);
		});
		document.querySelector("#qa").addEventListener('click', function (e) {
			console.log("Start qa")
			RevealQnA.toggleQnA();
		});
		document.addEventListener('keydown', (event) => {
			var name = event.key;
			var code = event.code;
			if (name === 'q' & event.ctrlKey) {
				RevealQnA.toggleQnA();;
			}
		}, false);
	</script>
</body>

</html>
